## МАТЕМАТИЧЕСКОЕ РЕШЕНИЕ ##

---

Начнем с того, что наш мультипликатор ``M`` возвращает число от 1 до 10000.  
Для каждого числа в нашей исходной последовательности ``sequence`` мы вызываем мультипликатор  
и по правилу:  
$$
g(x,M) = \begin{cases}
0, & M \le x\\
x, & M > x
\end{cases}
$$  
создаем новую последовательность чисел.

``rtp`` это наше мат ожидание $ \to $ 
$$
rtp = x \cdot \Pr(M>x)
$$
где:  
- x $\cdot$ Pr(M $>$ x) - вероятность того, что M > x, умножается на "выйгрыш" x
- 0 $\cdot$ Pr(M $\le$ x) - вероятность того, что M <= x, умножается на "выйгрыш", в нашем случае 0

И тогда задача превращается в формулу вида:

$$
x \cdot \Pr(M>x) = rtp
$$

---

Выразим нашу вероятность из формулы выше, и получим:

$$
\Pr(M>x) = \frac{rtp}{x}
$$

Тогда, вероятность что ``M`` превысит x, равна: $\dfrac{rtp}{x} $

 ---

### Найдем функцию распределения F(x) ###

$$
F(x) = \Pr(M \le x) = 1 - \Pr(M>x)
$$

Подставим выше найденную вероятность, и получим выражение вида:

$$
F(x) = 1 - \frac{rtp}{x}
$$

---

### Рассмотрим крайние границы ###
* При $x \to 1$:

$$
F(1)=1-\frac{rtp}{1}=1-rtp
$$

Следовательно существует точечная масса в $1$:

$$
\Pr(M=1)=F(1)-\lim_{x\to 1^-}F(x)=1-rtp
$$

* При $x \to 10000^-$:

$$
F(10000^-)=1-\frac{rtp}{10000}.
$$

Тогда оставшаяся (точечная) масса в точке $10000$ равна

$$
\Pr(M=10000)=1-F(10000^-)=\frac{rtp}{10000}.
$$


Мы рассматриваем крайние точки, тк там ломается общая формула и дает скачки в распределении.

---

### Теперь найдем плотность на интервале  ###

Если рассматривать абсолютно непрерывную часть $F$ на $(1,10000)$, её производная даёт плотность $f(x)$:

$$
f(x)=F'(x)=\frac{d}{dx}\Big(1-\frac{rtp}{x}\Big)=\frac{rtp}{x^2}
$$



Это **непрерывная часть** распределения.

---

### Какие промежуточные результаты у нас есть ###

-  $p_1 =   1 - \frac{rtp}{10000} $
- $ p_2 = \frac{rtp}{10000} $
- $f(x)=\dfrac{rtp}{x^2}$ на $(1,10000)$

---

### Проверка нормировки ###

Сумма всех вероятностей должна быть равна 1:

$$
(1-rtp) \quad + \quad \int_1^{10000} \frac{rtp}{x^2} dx \quad + \quad \frac{rtp}{10000}
$$

Интеграл:

$$
\int_1^{10000} \frac{rtp}{x^2} dx = rtp \cdot \left(1 - \frac{1}{10000}\right)
$$

Суммируем:

$$
1 - rtp + rtp \left(1 - \frac{1}{10000}\right) + \frac{rtp}{10000} = 1
$$

Ч.Т.Д

---
### Проверка условия ###
Для любого $x \in [1,10000)$:

$$
\Pr(M>x) = \int_x^{10000} \frac{rtp}{t^2} dt + \Pr(M=10000)
$$

Считаем:

$$
= rtp\left(\frac{1}{x} - \frac{1}{10000}\right) + \frac{rtp}{10000} = \frac{rtp}{x}
$$

Подставляем в ожидание:

$$
x \cdot \frac{rtp}{x} = rtp
$$

Ч.Т.Д

---
### Что нам возвращать и по каким правилам ###

Возьмем равномерную случайную величину $U \in (0,1). $ Имея функцию распределения $F$, получим выборку $ M $ через обратную функцию $F^{-1}$.

$$
M(U) =
\begin{cases}
1, & U < 1 - rtp, \\[6pt]
\dfrac{rtp}{1-U}, & 1-rtp \le U < 1 - \tfrac{rtp}{10000}, \\[6pt]
10000, & U \ge 1 - \tfrac{rtp}{10000}
\end{cases}
$$

---

## Дальше смотреть код $ \to $



   




